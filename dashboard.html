<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>City-Restricted Route Dashboard</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
  body { font-family: 'Inter', sans-serif; }

  #map {
    width: 100%;
    height: 100%;
    min-height: 200px; /* minimum height on mobile */
    border-radius: 1rem;
  }

  #directionsPanel { overflow-y: auto; }

  #directionsText {
    font-size: 0.95rem;
    line-height: 1.5;
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
  }

  #directionsText .step {
    display: flex;
    align-items: flex-start;
    gap: 0.75rem;
    padding: 0.75rem;
    border-radius: 0.75rem;
    background-color: #f9fafb;
    transition: background 0.2s;
  }

  #directionsText .step:hover { background-color: #eef2ff; }

  #directionsText .step-icon {
    flex-shrink: 0;
    width: 1.75rem;
    height: 1.75rem;
    background-color: #3b82f6;
    color: white;
    display: flex;
    justify-content: center;
    align-items: center;
    border-radius: 9999px;
    font-size: 0.85rem;
  }

  #directionsText .step-info { flex: 1; }

  #directionsText .step-info .mode {
    font-weight: 600;
    color: #1e40af;
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  #directionsText .step-info .details {
    font-size: 0.875rem;
    color: #4b5563;
    margin-top: 0.25rem;
  }

  .transport-icon { width: 1rem; height: 1rem; display: inline-block; }

  /* Responsive adjustments */
  @media (max-width: 1024px) {
    .inputs-container { flex-direction: column; gap: 2; }
    #pointA, #pointB, #getRoute { width: 100%; }
  }

  @media (max-width: 768px) {
    #map { height: 250px; min-height: 250px; }
    #directionsPanel { height: auto; max-height: 250px; padding-bottom: 80px; }
  }

  @media (max-width: 480px) {
    #map { height: 200px; min-height: 200px; }
    #directionsPanel { max-height: 200px; }
  }
</style>
</head>
<body class="bg-gray-100 h-screen">

<!-- City Selection and Input Form -->
<div class="p-4 flex flex-col md:flex-row gap-3 items-center inputs-container">
  <select id="citySelect" class="flex-1 p-3 rounded-xl border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-400">
    <option value="" disabled selected>Select your city</option>
    <option value="Cebu City">Cebu City</option>
    <option value="Manila">Manila</option>
  </select>

  <input id="pointA" type="text" placeholder="Point A" class="flex-1 p-3 rounded-xl border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-400" disabled>
  <input id="pointB" type="text" placeholder="Point B" class="flex-1 p-3 rounded-xl border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-400" disabled>
  <button id="getRoute" class="bg-blue-500 text-white py-3 px-5 rounded-xl hover:bg-blue-600 transition" disabled>Get Route</button>
</div>

<!-- Two-column layout -->
<div class="flex flex-col md:flex-row h-[calc(100vh-160px)] md:h-[calc(100vh-180px)] p-4 gap-4">
  <!-- Left: Google Map -->
  <div class="flex-1 bg-white rounded-2xl shadow overflow-hidden flex flex-col">
    <div id="map" class="flex-1 min-h-[200px]"></div>
  </div>

  <!-- Right: Public Transportation Directions -->
  <div class="w-full md:w-1/3 bg-white rounded-2xl shadow p-4 flex flex-col" id="directionsPanel">
    <h2 class="font-semibold text-xl mb-4 text-gray-700 border-b pb-2">Public Transport Directions</h2>
    <div id="directionsText" class="text-gray-700 text-sm">
      <p class="text-gray-500">Select your city and enter Point A and Point B, then click <span class="font-semibold">Get Route</span>.</p>
    </div>
  </div>
</div>

<!-- Bottom Mobile-Style Navbar -->
<nav class="fixed bottom-4 left-1/2 transform -translate-x-1/2 w-11/12 bg-white rounded-3xl shadow-xl px-6 py-3 flex justify-between items-center">
  <button class="flex flex-col items-center text-gray-500 hover:text-blue-500 transition-colors duration-200">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12h18M3 6h18M3 18h18" />
    </svg>
    <span class="text-xs font-medium">Home</span>
  </button>
  <button class="flex flex-col items-center text-gray-500 hover:text-blue-500 transition-colors duration-200">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
    </svg>
    <span class="text-xs font-medium">Add</span>
  </button>
  <button class="flex flex-col items-center text-gray-500 hover:text-blue-500 transition-colors duration-200">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
    </svg>
    <span class="text-xs font-medium">Tasks</span>
  </button>
  <button class="flex flex-col items-center text-gray-500 hover:text-blue-500 transition-colors duration-200">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 12c2.21 0 4-1.79 4-4S14.21 4 12 4 8 5.79 8 8s1.79 4 4 4z" />
    </svg>
    <span class="text-xs font-medium">Account</span>
  </button>
</nav>

<script>
let map, directionsService, directionsRenderer;
let autocompleteA, autocompleteB;
let geocoder;

function initMap() {
  map = new google.maps.Map(document.getElementById("map"), {
    center: { lat: 10.3157, lng: 123.8854 }, // Cebu City default
    zoom: 13,
  });
  directionsService = new google.maps.DirectionsService();
  directionsRenderer = new google.maps.DirectionsRenderer({ map: map });
  geocoder = new google.maps.Geocoder();
}

document.getElementById("citySelect").addEventListener("change", () => {
  const city = document.getElementById("citySelect").value;
  if (!city) return;
  document.getElementById("pointA").disabled = false;
  document.getElementById("pointB").disabled = false;
  document.getElementById("getRoute").disabled = false;

  geocoder.geocode({ address: city }, (results, status) => {
    if (status === "OK" && results[0]) {
      const bounds = results[0].geometry.viewport;
      const options = { bounds: bounds, strictBounds: true, fields: ["name", "geometry"], types: ["establishment", "geocode"] };
      autocompleteA = new google.maps.places.Autocomplete(document.getElementById("pointA"), options);
      autocompleteB = new google.maps.places.Autocomplete(document.getElementById("pointB"), options);
      map.fitBounds(bounds);
    }
  });
});

function getTransportIcon(mode) {
  switch(mode) { case "WALKING": return "ðŸš¶"; case "TRANSIT": return "ðŸšŒ"; case "RAIL": return "ðŸš†"; default: return "â“"; }
}

document.getElementById("getRoute").addEventListener("click", () => {
  const pointA = document.getElementById("pointA").value;
  const pointB = document.getElementById("pointB").value;
  if (!pointA || !pointB) { alert("Please enter both Point A and Point B"); return; }

  directionsService.route({
    origin: pointA,
    destination: pointB,
    travelMode: google.maps.TravelMode.TRANSIT,
  }, (response, status) => {
    if (status === "OK") {
      directionsRenderer.setDirections(response);
      const steps = response.routes[0].legs[0].steps;
      const container = document.getElementById("directionsText");
      container.innerHTML = "";
      steps.forEach((step, index) => {
        const div = document.createElement("div");
        div.className = "step";
        let transportText = "";
        let mode = step.travel_mode.toUpperCase();
        const icon = getTransportIcon(mode);
        if(step.transit) {
          const lineName = step.transit.line.short_name || step.transit.line.name || "";
          const vehicleType = step.transit.line.vehicle.type || "TRANSIT";
          const depStop = step.transit.departure_stop ? step.transit.departure_stop.name : "";
          const arrStop = step.transit.arrival_stop ? step.transit.arrival_stop.name : "";
          transportText = `${vehicleType} ${lineName} from ${depStop} â†’ ${arrStop}`;
        } else { transportText = step.instructions.replace(/<[^>]*>?/gm, ""); }
        div.innerHTML = `<div class="step-icon">${index+1}</div>
          <div class="step-info"><div class="mode"><span class="transport-icon">${icon}</span> ${mode}</div>
          <div class="details">${transportText} (${step.duration.text})</div></div>`;
        container.appendChild(div);
      });
    } else { alert("Directions request failed: " + status); }
  });
});
</script>

<script async
src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBFSBBi31TWkJKbhwIQVnK4UdjUgksZ6nE&libraries=places&callback=initMap">
</script>

</body>
</html>
